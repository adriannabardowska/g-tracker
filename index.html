<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#C8A2D0">
    <link rel="manifest" href="manifest.json">
    <title>üçë Glute Tracker</title>
    <style>
        /* ===== CSS RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #C8A2D0;
            --primary-dark: #B88FC7;
            --secondary: #2C2C2C;
            --success: #B8E6D5;
            --success-dark: #A0D4C3;
            --warning: #FFC107;
            --danger: #F44336;
            --bg: #FFFFFF;
            --bg-secondary: #F8F4F9;
            --text: #2C2C2C;
            --text-secondary: #666666;
            --border: #E8D9EC;
            --shadow: rgba(200, 162, 208, 0.15);
            --gradient-start: #C8A2D0;
            --gradient-mid: #E5B8D0;
            --gradient-end: #F5DCC8;
            --success-gradient-start: #D4EFE3;
            --success-gradient-end: #C8E3F0;
        }

        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap');

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        /* ===== LAYOUT ===== */
        .app-container {
            max-width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-mid) 50%, var(--gradient-end) 100%);
            color: white;
            padding: 1rem;
            box-shadow: 0 2px 8px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .header-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        main {
            flex: 1;
            padding: 1rem;
            padding-bottom: 80px;
        }

        /* ===== NAVIGATION ===== */
        .nav-tabs {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 0.5rem 0;
            box-shadow: 0 -2px 8px var(--shadow);
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.75rem;
            border: none;
            background: none;
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 700;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
            transition: color 0.2s;
        }

        .nav-tab.active {
            color: var(--primary);
            font-weight: 700;
        }

        .nav-tab-icon {
            display: none;
        }

        /* ===== BUTTONS ===== */
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:active {
            background: var(--primary-dark);
            transform: scale(0.98);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-gradient-start), var(--success-gradient-end));
            color: #4A7C6B;
        }

        .btn-block {
            width: 100%;
            display: block;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            min-height: 36px;
        }

        /* ===== CARDS ===== */
        .card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--bg-secondary);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
        }

        .card-badge {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-mid));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* ===== VIEWS ===== */
        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* ===== HOME VIEW ===== */
        .week-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .week-selector select {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
            background: white;
        }

        .workout-grid {
            display: grid;
            gap: 1rem;
        }

        .workout-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px var(--shadow);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 4px solid var(--gradient-mid);
        }

        .workout-card:active {
            transform: scale(0.98);
        }

        .workout-card.completed {
            border-left-color: var(--success);
            background: linear-gradient(135deg, #f0fdf9 0%, #f0f9fd 100%);
        }

        .workout-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .workout-card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
        }

        .workout-card-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* ===== WORKOUT VIEW ===== */
        .exercise-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .exercise-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .exercise-card.completed {
            background: linear-gradient(135deg, #f0fdf9 0%, #f0f9fd 100%);
            border: 2px solid var(--success);
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }

        .exercise-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            flex: 1;
        }

        .exercise-target {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }

        .exercise-tips {
            background: var(--bg-secondary);
            padding: 0.75rem;
            border-radius: 8px;
            margin: 0.75rem 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .exercise-tips-toggle {
            color: var(--gradient-start);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: inline-block;
        }

        .exercise-previous {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border-radius: 6px;
        }

        .sets-logged {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 0.75rem 0;
        }

        .set-chip {
            background: linear-gradient(135deg, var(--success-gradient-start), var(--success-gradient-end));
            color: #4A7C6B;
            padding: 0.5rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .exercise-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* ===== MODAL ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .modal-close {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            border: none;
            background: none;
            font-family: 'Montserrat', sans-serif;
            padding: 0;
            width: 32px;
            height: 32px;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* ===== REST TIMER ===== */
        .rest-timer {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--secondary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            z-index: 200;
            display: none;
            text-align: center;
            min-width: 200px;
        }

        .rest-timer.active {
            display: block;
        }

        .rest-timer-time {
            font-size: 2rem;
            font-weight: 700;
            margin: 0.5rem 0;
            color: #9CA3AF;
        }

        .rest-timer-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .rest-timer-actions button {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
        }

        /* ===== PROGRESS PHOTOS ===== */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .photo-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .photo-card-info {
            padding: 0.75rem;
        }

        .photo-card-date {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text);
        }

        .photo-card-week {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .add-photo-btn {
            position: fixed;
            bottom: 80px;
            right: 1rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-mid));
            color: white;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 4px 12px var(--shadow);
            z-index: 90;
        }

        /* ===== UTILITIES ===== */
        .text-center { text-align: center; }
        .text-secondary { color: var(--text-secondary); }
        .mt-1 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 1rem; }
        .hidden { display: none !important; }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .success-checkmark {
            color: var(--success-dark);
            font-size: 1.25rem;
        }

        /* ===== SETTINGS VIEW ===== */
        .settings-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .settings-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
        }

        .settings-item:active {
            background: var(--bg-secondary);
        }

        /* ===== RESPONSIVE ===== */
        @media (min-width: 768px) {
            main {
                max-width: 768px;
                margin: 0 auto;
            }
        }

        /* ===== ANIMATIONS ===== */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <div>
                    <div class="header-title">üçë Glute Tracker</div>
                    <div class="header-subtitle" id="headerSubtitle">Week 1</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Home View -->
            <div id="homeView" class="view active">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Select Week</div>
                    </div>
                    <div class="week-selector">
                        <select id="weekSelector" class="form-input">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">This Week</div>
                        <div class="card-badge" id="weekProgress">0/4</div>
                    </div>
                    <div class="workout-grid" id="workoutGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Workout View -->
            <div id="workoutView" class="view">
                <button onclick="app.goHome()" class="btn btn-secondary btn-sm mb-1">‚Üê Back</button>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title" id="workoutTitle">Workout</div>
                    </div>
                    <div class="exercise-list" id="exerciseList">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <button onclick="app.completeWorkout()" class="btn btn-success btn-block mt-1">‚úì Complete Workout</button>
            </div>

            <!-- Photos View -->
            <div id="photosView" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Progress Photos</div>
                    </div>
                    <p class="text-secondary" style="margin-bottom: 1rem; font-size: 0.9rem;">
                        Photos are saved as files to your device. Keep them organized in a folder for easy tracking!
                    </p>
                    <div class="photo-grid" id="photoGrid">
                        <!-- Populated by JS -->
                    </div>
                    <div id="emptyPhotos" class="empty-state">
                        <div class="empty-state-icon">üì∏</div>
                        <p>No progress photos yet</p>
                        <p class="text-secondary">When you add photos, they'll be downloaded to your device</p>
                    </div>
                </div>
                <button class="add-photo-btn" onclick="app.openAddPhotoModal()">+</button>
            </div>

            <!-- Settings View -->
            <div id="settingsView" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Settings</div>
                    </div>
                    <div class="settings-list">
                        <div class="settings-item" onclick="app.exportData()">
                            <span>üì• Export Workout Data</span>
                            <span>‚Üí</span>
                        </div>
                        <div class="settings-item" onclick="app.importData()">
                            <span>üì§ Import Workout Data</span>
                            <span>‚Üí</span>
                        </div>
                        <div class="settings-item" onclick="app.clearAllData()">
                            <span style="color: var(--danger)">üóëÔ∏è Clear All Data</span>
                            <span>‚Üí</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">About</div>
                    </div>
                    <p class="text-secondary">Glute Growth & Lift Program</p>
                    <p class="text-secondary">Version 1.0</p>
                    <p class="text-secondary" style="margin-top: 1rem;">Built by Ada with CC friend</p>
                </div>
            </div>
        </main>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="app.showView('home')">
                <span>HOME</span>
            </button>
            <button class="nav-tab" onclick="app.showView('photos')">
                <span>PHOTOS</span>
            </button>
            <button class="nav-tab" onclick="app.showView('settings')">
                <span>SETTINGS</span>
            </button>
        </nav>

        <!-- Log Set Modal -->
        <div id="logSetModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="modalTitle">Log Set</h3>
                    <button class="modal-close" onclick="app.closeModal('logSetModal')">√ó</button>
                </div>
                <form id="logSetForm" onsubmit="app.saveSet(event)">
                    <div class="form-group">
                        <label class="form-label">Set Number</label>
                        <input type="text" id="setNumber" class="form-input" readonly>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Weight (kg)</label>
                            <input type="number" id="setWeight" class="form-input" required step="0.5" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Reps</label>
                            <input type="number" id="setReps" class="form-input" required min="1">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Save Set</button>
                </form>
            </div>
        </div>

        <!-- Add Photo Modal -->
        <div id="addPhotoModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Add Progress Photo</h3>
                    <button class="modal-close" onclick="app.closeModal('addPhotoModal')">√ó</button>
                </div>
                <form id="addPhotoForm" onsubmit="app.savePhoto(event)">
                    <div class="form-group">
                        <label class="form-label">Photo</label>
                        <input type="file" id="photoInput" class="form-input" accept="image/*" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Week</label>
                        <input type="number" id="photoWeek" class="form-input" min="1" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes (Optional)</label>
                        <textarea id="photoNotes" class="form-input" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Glute Circumference (inches, optional)</label>
                        <input type="number" id="photoMeasurement" class="form-input" step="0.1" min="0">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Save Photo</button>
                </form>
            </div>
        </div>

        <!-- Weekly Photo Prompt Modal -->
        <div id="weeklyPhotoModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Week Complete! üéâ</h3>
                </div>
                <p style="margin-bottom: 1.5rem; text-align: center;">
                    Congratulations on completing this week!<br>
                    Would you like to add progress photos?
                </p>
                <button onclick="app.acceptWeeklyPhoto()" class="btn btn-primary btn-block mb-1">Yes, Take Photos</button>
                <button onclick="app.skipWeeklyPhoto()" class="btn btn-secondary btn-block mb-1">Skip This Week</button>
                <button onclick="app.remindLaterPhoto()" class="btn btn-secondary btn-block">Remind Me Later</button>
            </div>
        </div>

        <!-- Rest Timer -->
        <div id="restTimer" class="rest-timer">
            <div>Rest Time</div>
            <div class="rest-timer-time" id="timerDisplay">2:00</div>
            <div class="rest-timer-actions">
                <button onclick="app.skipTimer()">Skip</button>
                <button onclick="app.restartTimer()">Restart</button>
            </div>
        </div>
    </div>

    <!-- Hidden file input for import -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="app.handleImport(event)">

    <script>
// =============================================================================
// GLUTE TRACKER APP - Main Application
// =============================================================================

const app = {
    // Data
    data: {
        workouts: [],
        progressPhotos: [],
        currentWeek: 1,
        settings: {
            photoPromptDismissed: {}
        }
    },

    // Current state
    state: {
        currentView: 'home',
        currentWorkout: null,
        currentExerciseIndex: null,
        timerInterval: null,
        timerSeconds: 0
    },

    // Workout Program Data
    program: {
        days: [
            {
                id: 'day1',
                name: 'Monday - Glutes (Heavy Compounds + Isolation)',
                exercises: [
                    {
                        name: 'Barbell Hip Thrust',
                        sets: 3,
                        repsRange: '6-8',
                        restTime: 120,
                        tips: 'Drive through heels, toes can lift slightly, posterior pelvic tilt at top',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/0.jpg'
                    },
                    {
                        name: 'Barbell Glute Bridge',
                        sets: 3,
                        repsRange: '10-12',
                        restTime: 120,
                        tips: 'Heels close to glutes, squeeze hard for 2 sec at top',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Glute_Bridge/0.jpg'
                    },
                    {
                        name: 'Romanian Deadlifts (RDLs)',
                        sets: 3,
                        repsRange: '8-10',
                        restTime: 120,
                        tips: 'Hinge at hips, slight knee bend, feel stretch in hamstrings and glutes',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Romanian_Deadlift/0.jpg'
                    },
                    {
                        name: 'Single Leg Hip Thrust',
                        sets: 3,
                        repsRange: '10 per leg',
                        restTime: 90,
                        tips: 'Extend non-working leg straight, focus on upper glute squeeze',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/tA0oq2JAbCDU7r'
                    },
                    {
                        name: 'Cable Straight Leg Kickbacks',
                        sets: 3,
                        repsRange: '12-15 per leg',
                        restTime: 90,
                        tips: 'Maintain 90¬∞ angle with kneeling leg, push working leg to hip extension',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/02FPgaS9eeJVFp'
                    },
                    {
                        name: 'Hip Abduction Machine',
                        sets: 3,
                        repsRange: '15-20',
                        restTime: 60,
                        tips: 'Controlled, not momentum',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/r4jN-a0EgBvSuj'
                    },
                    {
                        name: 'BURNOUT: Banded Frog Pumps',
                        sets: 1,
                        repsRange: '20-30 or failure',
                        restTime: 60,
                        tips: 'Band above knees, soles together, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Frog-Pump.gif'
                    },
                    {
                        name: 'BURNOUT: Banded Donkey Kicks',
                        sets: 1,
                        repsRange: '20-30 per leg or failure',
                        restTime: 0,
                        tips: 'All fours, drive heel to ceiling, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/TDqzgOrv0Ir2nJ'
                    }
                ]
            },
            {
                id: 'day2',
                name: 'Tuesday - Upper Body (Push)',
                exercises: [
                    {
                        name: 'Incline Dumbbell Press',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 90,
                        tips: 'Press at 30-45¬∞ angle, focus on upper chest and shoulders',
                        category: 'push',
                        imageUrl: 'https://v2.exercisedb.io/image/R5l2xqPjwk1Z5i'
                    },
                    {
                        name: 'Face Pulls',
                        sets: 3,
                        repsRange: '15-20',
                        restTime: 60,
                        tips: 'Pull towards face, elbows high, squeeze shoulder blades',
                        category: 'push',
                        imageUrl: 'https://v2.exercisedb.io/image/kSpoKnPCAHoU2t'
                    },
                    {
                        name: 'Lateral Raises',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 60,
                        tips: 'Slight bend in elbows, lift to shoulder height',
                        category: 'push',
                        imageUrl: 'https://v2.exercisedb.io/image/mGkLf0d6TbQWJQ'
                    },
                    {
                        name: 'Tricep Pushdowns',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 60,
                        tips: 'Keep elbows tucked, full extension at bottom',
                        category: 'push',
                        imageUrl: 'https://v2.exercisedb.io/image/ugvJxUZGjwOWel'
                    }
                ]
            },
            {
                id: 'day3',
                name: 'Wednesday - Glutes (Isolation + Pump)',
                exercises: [
                    {
                        name: 'Single Leg Glute Bridge',
                        sets: 3,
                        repsRange: '12 per leg',
                        restTime: 90,
                        tips: 'Extend non-working leg straight, don\'t let hips rotate',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/tA0oq2JAbCDU7r'
                    },
                    {
                        name: 'Lateral Leg Raises',
                        sets: 3,
                        repsRange: '15 per leg',
                        restTime: 60,
                        tips: 'Lie on side, lift top leg up, focus on outer glute',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/IIImMNBsjDTGQg'
                    },
                    {
                        name: 'Cable Straight Leg Kickbacks',
                        sets: 3,
                        repsRange: '12-15 per leg',
                        restTime: 90,
                        tips: 'Maintain 90¬∞ angle with kneeling leg, push working leg to hip extension',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/02FPgaS9eeJVFp'
                    },
                    {
                        name: '45¬∞ Back Extensions',
                        sets: 3,
                        repsRange: '15-20',
                        restTime: 90,
                        tips: 'Round upper back slightly, focus on hip hinge for glute activation',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/jNJF-K1f-YpJq3'
                    },
                    {
                        name: 'Frog Pumps',
                        sets: 3,
                        repsRange: '25-30',
                        restTime: 60,
                        tips: 'Soles together, hips in external rotation, bodyweight only',
                        category: 'glutes',
                        imageUrl: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Frog-Pump.gif'
                    },
                    {
                        name: 'Fire Hydrants',
                        sets: 3,
                        repsRange: '20 per leg',
                        restTime: 60,
                        tips: 'All fours, lift leg to side, keep knee bent 90¬∞',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/VqEI4oWkq7XH8r'
                    },
                    {
                        name: 'Hip Abduction Machine',
                        sets: 2,
                        repsRange: '15-20',
                        restTime: 60,
                        tips: 'Controlled, not momentum',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/r4jN-a0EgBvSuj'
                    },
                    {
                        name: 'BURNOUT: Banded Frog Pumps',
                        sets: 1,
                        repsRange: '20-30 or failure',
                        restTime: 60,
                        tips: 'Band above knees, soles together, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Frog-Pump.gif'
                    },
                    {
                        name: 'BURNOUT: Banded Donkey Kicks',
                        sets: 1,
                        repsRange: '20-30 per leg or failure',
                        restTime: 0,
                        tips: 'All fours, drive heel to ceiling, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/TDqzgOrv0Ir2nJ'
                    }
                ]
            },
            {
                id: 'day4',
                name: 'Thursday - Upper Body (Pull)',
                exercises: [
                    {
                        name: 'Pull-ups or Lat Pulldown',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 90,
                        tips: 'Full range of motion, squeeze lats at bottom',
                        category: 'pull',
                        imageUrl: 'https://v2.exercisedb.io/image/yAqYV4t8tZPQ-f'
                    },
                    {
                        name: 'Barbell or Dumbbell Rows',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 90,
                        tips: 'Pull to lower chest, squeeze shoulder blades',
                        category: 'pull',
                        imageUrl: 'https://v2.exercisedb.io/image/bPb7rEz1cQxs-2'
                    },
                    {
                        name: 'Face Pulls',
                        sets: 3,
                        repsRange: '15-20',
                        restTime: 60,
                        tips: 'Pull towards face, elbows high, squeeze shoulder blades',
                        category: 'pull',
                        imageUrl: 'https://v2.exercisedb.io/image/kSpoKnPCAHoU2t'
                    },
                    {
                        name: 'Bicep Curls',
                        sets: 3,
                        repsRange: '12-15',
                        restTime: 60,
                        tips: 'Control the weight, full range of motion',
                        category: 'pull',
                        imageUrl: 'https://v2.exercisedb.io/image/s1TyRxv8w52o2T'
                    }
                ]
            },
            {
                id: 'day5',
                name: 'Friday - Glutes (Heavy Compounds + Isolation)',
                exercises: [
                    {
                        name: 'Sumo Squats',
                        sets: 3,
                        repsRange: '8-10',
                        restTime: 120,
                        tips: 'Wide stance, toes out 45¬∞, sit back into hips, focus on glute squeeze',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Sumo_Squat/0.jpg'
                    },
                    {
                        name: 'Barbell Hip Thrust',
                        sets: 3,
                        repsRange: '6-8',
                        restTime: 120,
                        tips: 'Try to beat Monday weights! Drive through heels',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/0.jpg'
                    },
                    {
                        name: 'Barbell Glute Bridge',
                        sets: 3,
                        repsRange: '10-12',
                        restTime: 120,
                        tips: 'Heels close to glutes, squeeze hard for 2 sec at top',
                        category: 'glutes',
                        imageUrl: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Glute_Bridge/0.jpg'
                    },
                    {
                        name: 'Single Leg Hip Thrust',
                        sets: 3,
                        repsRange: '10 per leg',
                        restTime: 90,
                        tips: 'Extend non-working leg straight, focus on upper glute squeeze',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/tA0oq2JAbCDU7r'
                    },
                    {
                        name: 'Cable Straight Leg Kickbacks',
                        sets: 3,
                        repsRange: '12-15 per leg',
                        restTime: 90,
                        tips: 'Maintain 90¬∞ angle with kneeling leg, push working leg to hip extension',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/02FPgaS9eeJVFp'
                    },
                    {
                        name: 'Hip Abduction Machine',
                        sets: 3,
                        repsRange: '15-20',
                        restTime: 60,
                        tips: 'Controlled, not momentum',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/r4jN-a0EgBvSuj'
                    },
                    {
                        name: 'BURNOUT: Banded Frog Pumps',
                        sets: 1,
                        repsRange: '20-30 or failure',
                        restTime: 60,
                        tips: 'Band above knees, soles together, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Frog-Pump.gif'
                    },
                    {
                        name: 'BURNOUT: Reverse Hypers (banded)',
                        sets: 1,
                        repsRange: '20-30 or failure',
                        restTime: 0,
                        tips: 'Hip extension, legs straight, push to failure',
                        category: 'glutes',
                        imageUrl: 'https://v2.exercisedb.io/image/02FPgaS9eeJVFp'
                    }
                ]
            }
        ]
    },

    // Initialize app
    init() {
        this.loadData();
        this.setupWeekSelector();
        this.renderHome();
        this.checkWeeklyPhotoPrompt();
    },

    // Load data from localStorage
    loadData() {
        const stored = localStorage.getItem('gluteTrackerData');
        if (stored) {
            this.data = JSON.parse(stored);
        }
    },

    // Save data to localStorage
    saveData() {
        localStorage.setItem('gluteTrackerData', JSON.stringify(this.data));
    },

    // Setup week selector
    setupWeekSelector() {
        const selector = document.getElementById('weekSelector');
        selector.innerHTML = '';
        for (let i = 1; i <= 12; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `Week ${i}`;
            if (i === this.data.currentWeek) {
                option.selected = true;
            }
            selector.appendChild(option);
        }
        selector.addEventListener('change', (e) => {
            this.data.currentWeek = parseInt(e.target.value);
            this.saveData();
            this.renderHome();
        });
    },

    // Show view
    showView(viewName) {
        // Hide all views
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));

        // Show selected view
        const view = document.getElementById(`${viewName}View`);
        view.classList.add('active');

        // Update nav tabs
        document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
        event.currentTarget.classList.add('active');

        // Update header
        document.getElementById('headerSubtitle').textContent = `Week ${this.data.currentWeek}`;

        // Render view content
        if (viewName === 'home') {
            this.renderHome();
        } else if (viewName === 'photos') {
            this.renderPhotos();
        }

        this.state.currentView = viewName;
    },

    // Render home view
    renderHome() {
        const grid = document.getElementById('workoutGrid');
        grid.innerHTML = '';

        // Get workouts for current week
        const weekWorkouts = this.getWeekWorkouts();
        const completedCount = weekWorkouts.filter(w => w.completed).length;

        // Update progress badge
        document.getElementById('weekProgress').textContent = `${completedCount}/4`;
        document.getElementById('headerSubtitle').textContent = `Week ${this.data.currentWeek}`;

        // Render workout cards
        this.program.days.forEach((day, index) => {
            const workout = weekWorkouts.find(w => w.dayType === day.name);
            const isCompleted = workout && workout.completed;

            const card = document.createElement('div');
            card.className = `workout-card ${isCompleted ? 'completed' : ''}`;
            card.onclick = () => this.startWorkout(index);

            card.innerHTML = `
                <div class="workout-card-header">
                    <div class="workout-card-title">${day.name}</div>
                    ${isCompleted ? '<span class="success-checkmark">‚úì</span>' : ''}
                </div>
                <div class="workout-card-desc">
                    ${day.exercises.length} exercises
                    ${workout && workout.date ? `<br>Last: ${new Date(workout.date).toLocaleDateString()}` : ''}
                </div>
            `;

            grid.appendChild(card);
        });
    },

    // Get workouts for current week
    getWeekWorkouts() {
        return this.data.workouts.filter(w => w.week === this.data.currentWeek);
    },

    // Start workout
    startWorkout(dayIndex) {
        const day = this.program.days[dayIndex];
        this.state.currentWorkout = {
            dayIndex,
            day: day,
            exercises: day.exercises.map(e => ({
                ...e,
                setsLogged: []
            }))
        };

        // Switch to workout view
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('workoutView').classList.add('active');

        this.renderWorkout();
    },

    // Render workout view
    renderWorkout() {
        document.getElementById('workoutTitle').textContent = this.state.currentWorkout.day.name;

        const list = document.getElementById('exerciseList');
        list.innerHTML = '';

        this.state.currentWorkout.exercises.forEach((exercise, index) => {
            const card = document.createElement('div');
            card.className = `exercise-card ${exercise.setsLogged.length === exercise.sets ? 'completed' : ''}`;

            // Get previous workout data for this exercise
            const previousData = this.getPreviousExerciseData(exercise.name);

            const setsHtml = exercise.setsLogged.map(set =>
                `<span class="set-chip">Set ${set.setNumber}: ${set.weight} kg √ó ${set.reps}</span>`
            ).join('');

            card.innerHTML = `
                <div class="exercise-header">
                    <div style="flex: 1;">
                        <div class="exercise-name">${exercise.name}</div>
                        <div class="exercise-target">${exercise.sets} sets √ó ${exercise.repsRange} reps</div>
                    </div>
                    ${exercise.setsLogged.length === exercise.sets ? '<span class="success-checkmark">‚úì</span>' : ''}
                </div>
                ${exercise.tips ? `
                    <div class="exercise-tips-toggle" onclick="this.nextElementSibling.classList.toggle('hidden')">
                        üí° Tips
                    </div>
                    <div class="exercise-tips ${this.data.currentWeek > 4 ? 'hidden' : ''}">${exercise.tips}</div>
                ` : ''}
                ${previousData ? `<div class="exercise-previous">Previous: ${previousData}</div>` : ''}
                ${exercise.setsLogged.length > 0 ? `<div class="sets-logged">${setsHtml}</div>` : ''}
                <div class="exercise-actions">
                    ${exercise.setsLogged.length < exercise.sets ? `
                        <button onclick="app.openLogSetModal(${index})" class="btn btn-primary btn-block">
                            Log Set ${exercise.setsLogged.length + 1}/${exercise.sets}
                        </button>
                    ` : `
                        <button class="btn btn-success btn-block" disabled>
                            ‚úì Complete
                        </button>
                    `}
                </div>
            `;

            list.appendChild(card);
        });
    },

    // Get previous exercise data
    getPreviousExerciseData(exerciseName) {
        // Find most recent workout with this exercise
        const recentWorkouts = [...this.data.workouts]
            .sort((a, b) => new Date(b.date) - new Date(a.date));

        for (const workout of recentWorkouts) {
            const exercise = workout.exercises.find(e => e.name === exerciseName);
            if (exercise && exercise.sets.length > 0) {
                return exercise.sets
                    .map(s => `${s.weight}√ó${s.reps}`)
                    .join(', ');
            }
        }
        return null;
    },

    // Open log set modal
    openLogSetModal(exerciseIndex) {
        this.state.currentExerciseIndex = exerciseIndex;
        const exercise = this.state.currentWorkout.exercises[exerciseIndex];
        const setNumber = exercise.setsLogged.length + 1;

        document.getElementById('setNumber').value = `Set ${setNumber}`;

        // Pre-fill with previous set weight if available
        if (exercise.setsLogged.length > 0) {
            const lastSet = exercise.setsLogged[exercise.setsLogged.length - 1];
            document.getElementById('setWeight').value = lastSet.weight;
        } else {
            // Try to get from previous workout
            const previousData = this.getPreviousExerciseData(exercise.name);
            if (previousData) {
                const firstSet = previousData.split(',')[0].trim();
                const weight = firstSet.split('√ó')[0];
                document.getElementById('setWeight').value = weight;
            } else {
                document.getElementById('setWeight').value = '';
            }
        }

        document.getElementById('setReps').value = '';
        document.getElementById('logSetModal').classList.add('active');
    },

    // Save set
    saveSet(event) {
        event.preventDefault();

        const exerciseIndex = this.state.currentExerciseIndex;
        const exercise = this.state.currentWorkout.exercises[exerciseIndex];

        const setData = {
            setNumber: exercise.setsLogged.length + 1,
            weight: parseFloat(document.getElementById('setWeight').value),
            reps: parseInt(document.getElementById('setReps').value),
            completed: true
        };

        exercise.setsLogged.push(setData);

        this.closeModal('logSetModal');
        this.renderWorkout();

        // Start rest timer if not last set
        if (exercise.setsLogged.length < exercise.sets) {
            this.startRestTimer(exercise.restTime);
        }

        return false;
    },

    // Start rest timer
    startRestTimer(seconds) {
        this.state.timerSeconds = seconds;
        this.updateTimerDisplay();
        document.getElementById('restTimer').classList.add('active');

        this.state.timerInterval = setInterval(() => {
            this.state.timerSeconds--;
            this.updateTimerDisplay();

            if (this.state.timerSeconds <= 0) {
                this.stopTimer();
                this.playTimerSound();
            }
        }, 1000);
    },

    // Update timer display
    updateTimerDisplay() {
        const minutes = Math.floor(this.state.timerSeconds / 60);
        const seconds = this.state.timerSeconds % 60;
        document.getElementById('timerDisplay').textContent =
            `${minutes}:${seconds.toString().padStart(2, '0')}`;
    },

    // Stop timer
    stopTimer() {
        if (this.state.timerInterval) {
            clearInterval(this.state.timerInterval);
            this.state.timerInterval = null;
        }
        document.getElementById('restTimer').classList.remove('active');
    },

    // Skip timer
    skipTimer() {
        this.stopTimer();
    },

    // Restart timer
    restartTimer() {
        const exercise = this.state.currentWorkout.exercises[this.state.currentExerciseIndex];
        this.stopTimer();
        this.startRestTimer(exercise.restTime);
    },

    // Play timer sound
    playTimerSound() {
        // Create a simple beep sound
        const context = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = context.createOscillator();
        const gainNode = context.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(context.destination);

        oscillator.frequency.value = 800;
        oscillator.type = 'sine';

        gainNode.gain.setValueAtTime(0.3, context.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.5);

        oscillator.start(context.currentTime);
        oscillator.stop(context.currentTime + 0.5);
    },

    // Complete workout
    completeWorkout() {
        // Check if all exercises have all sets logged
        const allComplete = this.state.currentWorkout.exercises.every(e =>
            e.setsLogged.length === e.sets
        );

        if (!allComplete) {
            if (!confirm('Not all sets are logged. Complete anyway?')) {
                return;
            }
        }

        // Save workout
        const workout = {
            id: Date.now().toString(),
            date: new Date().toISOString(),
            week: this.data.currentWeek,
            dayType: this.state.currentWorkout.day.name,
            exercises: this.state.currentWorkout.exercises.map(e => ({
                name: e.name,
                sets: e.setsLogged
            })),
            completed: true
        };

        this.data.workouts.push(workout);

        // Check if week is complete
        const weekWorkouts = this.getWeekWorkouts();
        const completedCount = weekWorkouts.filter(w => w.completed).length;

        if (completedCount === 4) {
            // Week complete - move to next week and show photo prompt
            this.data.currentWeek++;
            this.showWeeklyPhotoPrompt();
        }

        this.saveData();

        alert('Workout completed! üéâ');

        this.goHome();
    },

    // Go home
    goHome() {
        this.showView('home');
        document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.nav-tab')[0].classList.add('active');
    },

    // Check weekly photo prompt
    checkWeeklyPhotoPrompt() {
        const currentWeek = this.data.currentWeek;
        const lastWeek = currentWeek - 1;

        if (lastWeek > 0 &&
            this.data.settings.photoPromptDismissed[lastWeek] === 'remind') {
            this.showWeeklyPhotoPrompt();
        }
    },

    // Show weekly photo prompt
    showWeeklyPhotoPrompt() {
        const currentWeek = this.data.currentWeek - 1; // Week just completed

        // Don't show if already dismissed for this week
        if (this.data.settings.photoPromptDismissed[currentWeek]) {
            return;
        }

        document.getElementById('weeklyPhotoModal').classList.add('active');
    },

    // Accept weekly photo
    acceptWeeklyPhoto() {
        const week = this.data.currentWeek - 1;
        this.data.settings.photoPromptDismissed[week] = 'accepted';
        this.saveData();

        document.getElementById('weeklyPhotoModal').classList.remove('active');
        this.openAddPhotoModal(week);
    },

    // Skip weekly photo
    skipWeeklyPhoto() {
        const week = this.data.currentWeek - 1;
        this.data.settings.photoPromptDismissed[week] = 'skipped';
        this.saveData();

        document.getElementById('weeklyPhotoModal').classList.remove('active');
    },

    // Remind later photo
    remindLaterPhoto() {
        const week = this.data.currentWeek - 1;
        this.data.settings.photoPromptDismissed[week] = 'remind';
        this.saveData();

        document.getElementById('weeklyPhotoModal').classList.remove('active');
    },

    // Open add photo modal
    openAddPhotoModal(week = null) {
        document.getElementById('photoWeek').value = week || this.data.currentWeek;
        document.getElementById('photoNotes').value = '';
        document.getElementById('photoMeasurement').value = '';
        document.getElementById('photoInput').value = '';
        document.getElementById('addPhotoModal').classList.add('active');
    },

    // Save photo
    async savePhoto(event) {
        event.preventDefault();

        const fileInput = document.getElementById('photoInput');
        const file = fileInput.files[0];

        if (!file) return false;

        const week = parseInt(document.getElementById('photoWeek').value);
        const notes = document.getElementById('photoNotes').value;
        const measurement = parseFloat(document.getElementById('photoMeasurement').value) || null;

        // Create photo metadata (no image data stored in localStorage)
        const photo = {
            id: Date.now().toString(),
            date: new Date().toISOString(),
            week: week,
            filename: `week-${week}-${Date.now()}.jpg`,
            notes: notes,
            measurements: {
                gluteCircumference: measurement
            }
        };

        this.data.progressPhotos.push(photo);
        this.saveData();

        // Download the photo file to user's device
        await this.downloadPhotoFile(file, photo.filename);

        this.closeModal('addPhotoModal');

        alert(`Photo saved! File downloaded as: ${photo.filename}\n\nKeep your progress photos in the same folder for easy tracking.`);

        this.renderPhotos();

        // Switch to photos view
        this.showView('photos');
        document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.nav-tab')[1].classList.add('active');

        return false;
    },

    // Download photo file
    async downloadPhotoFile(file, filename) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.onload = (e) => {
                const link = document.createElement('a');
                link.href = e.target.result;
                link.download = filename;
                link.click();
                resolve();
            };
            reader.readAsDataURL(file);
        });
    },


    // Render photos
    renderPhotos() {
        const grid = document.getElementById('photoGrid');
        const empty = document.getElementById('emptyPhotos');

        if (this.data.progressPhotos.length === 0) {
            grid.innerHTML = '';
            empty.classList.remove('hidden');
            return;
        }

        empty.classList.add('hidden');
        grid.innerHTML = '';

        // Sort by date, newest first
        const photos = [...this.data.progressPhotos].sort((a, b) =>
            new Date(b.date) - new Date(a.date)
        );

        photos.forEach(photo => {
            const card = document.createElement('div');
            card.className = 'photo-card';
            card.style.cursor = 'default';

            card.innerHTML = `
                <div style="height: 150px; background: var(--bg-secondary); display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                    <div style="text-align: center;">
                        <div style="font-size: 3rem;">üì∏</div>
                        <div style="font-size: 0.75rem; margin-top: 0.5rem;">${photo.filename}</div>
                    </div>
                </div>
                <div class="photo-card-info">
                    <div class="photo-card-date">${new Date(photo.date).toLocaleDateString()}</div>
                    <div class="photo-card-week">Week ${photo.week}</div>
                    ${photo.notes ? `<div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">${photo.notes}</div>` : ''}
                    ${photo.measurements.gluteCircumference ? `<div style="font-size: 0.75rem; color: var(--text-secondary);">Circumference: ${photo.measurements.gluteCircumference}"</div>` : ''}
                </div>
            `;

            grid.appendChild(card);
        });
    },


    // Export data
    exportData() {
        const dataStr = JSON.stringify(this.data, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = `glute-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
        a.click();

        URL.revokeObjectURL(url);

        alert('Data exported! üì•');
    },

    // Import data
    importData() {
        document.getElementById('importFileInput').click();
    },

    // Handle import
    handleImport(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const imported = JSON.parse(e.target.result);

                if (confirm('This will replace all current data. Continue?')) {
                    this.data = imported;
                    this.saveData();
                    this.init();
                    alert('Data imported successfully! üì§');
                }
            } catch (error) {
                alert('Error importing data. Please check the file.');
            }
        };
        reader.readAsText(file);
    },

    // Clear all data
    clearAllData() {
        if (confirm('Are you sure? This will delete ALL your workout data and photos.')) {
            if (confirm('This cannot be undone. Are you REALLY sure?')) {
                localStorage.removeItem('gluteTrackerData');
                this.data = {
                    workouts: [],
                    progressPhotos: [],
                    currentWeek: 1,
                    settings: {
                        photoPromptDismissed: {}
                    }
                };
                this.init();
                alert('All data cleared.');
            }
        }
    },

    // Close modal
    closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    },

};

// Initialize app when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    app.init();
});

// Close modals on outside click
document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.remove('active');
        }
    });
});

// Register Service Worker for PWA functionality
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
            .then((registration) => {
                console.log('ServiceWorker registered:', registration.scope);
            })
            .catch((error) => {
                console.log('ServiceWorker registration failed:', error);
            });
    });
}
    </script>
</body>
</html>
